# log 2026-02-14

last updated: 2026-02-14

## v2.0.0 strategic overhaul

### what was done

**Phase 1: trace.py rewrite (critical)**
- Removed parse_llmfiles_output(), build_dependency_graph(), analyze_imports_from_file()
- Replaced with trace_with_library() using CallTracer from llmfiles.core.import_tracer
- Added structlog suppression (WARNING level) to keep stdout clean for JSON
- Added project root detection and hub module scoring
- Kept subprocess fallback via llmfiles_wrapper.py

**Phase 2: new trace.py flags**
- --grep PATTERN: find files by content, then trace dependencies
- --since DATE: filter to recently changed files via git

**Phase 3: LSP integration guidance**
- Added "Combined Analysis with LSP" section to SKILL.md
- Added workflows 6-8 to references/workflows.md

**Phase 4: analyze.py enrichment**
- Added docstring, decorator, base class, type annotation, return type extraction
- Added AsyncFunctionDef support

**Phase 5: documentation updates**
- CLAUDE.md, README.md, docs/usage.md updated

**Phase 6: tests and finalization**
- 82 tests pass (replaced deleted function tests, added new architecture tests)
- CHANGELOG.md and version bump to 2.0.0

**Post-v2.0.0 fixes**
- Fixed compare.py normalize_graph() to handle v2.0 call_graph dict edge format ({to, module, line} instead of strings)
- Fixed compare.py to read from "call_graph" key (with "graph" fallback for backward compatibility)
- Fixed compare.py external deps comparison to handle dict format (package -> importing files)
- Added .gitignore entry for scripts/internal/log/ trace artifacts
- Added Pyright LSP documentation to README.md (light) and docs/usage.md (detailed)
- Added test_graph_diff_v2_format test for new compare format (93 tests pass)

### real-world test results

Tested against llm-dit-experiments (54 Python files):
- 54 files traced from generate.py entry point
- 5 hub modules identified with scores
- Call graph edges include line numbers
- External deps correctly classified
- 172ms total duration
